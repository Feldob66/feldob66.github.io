<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-en="Web Tech Playground" data-hu="Web Tech JÃ¡tszÃ³tÃ©r">Web Tech Playground</title>
    
    <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
    <link rel="stylesheet" href="../styles/styles.css">
    
    <style>
        /* Light Silver text for the entire playground */
        body {
            color: #C0C0C0; 
        }

        .container { 
            max-width: 800px; 
            padding-top: 60px; 
            padding-bottom: 40px; 
        }

        /* Lighter Orange Glassmorphism for the containers */
        .playground-card {
            background: rgba(255, 165, 0, 0.15); /* Light Orange tint */
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 200, 100, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            text-align: center;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        /* Ensuring all text within cards stays light silver */
        .playground-card h2, .playground-card h3, .playground-card p, .playground-card span {
            color: #E0E0E0; /* Silver/Off-white */
        }

        input, button {
            padding: 12px; border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.1);
            color: white; margin: 5px;
            transition: all 0.2s ease;
        }

        button:hover { 
            background: rgba(255, 165, 0, 0.3); /* Orange glow on hover */
            cursor: pointer; 
            transform: translateY(-1px); 
        }

        .emoji-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(45px, 1fr));
            gap: 10px; padding: 15px; 
            background: rgba(0,0,0,0.2); 
            border-radius: 12px;
        }

        .calc-row { display: flex; justify-content: center; align-items: center; gap: 8px; margin-bottom: 8px; }
        
        .result-btn { 
            background: #000; 
            color: #FF7F50; 
            border: 1px solid #FF7F50; 
            min-width: 80px; 
            font-weight: bold; 
        }

        .btndsbl2 { 
            background: rgba(0,0,0,0.3); 
            border-color: #FFA500; 
            color: #C0C0C0;
            cursor: default; 
            min-width: 150px; 
        }

        .hidden { display: none; }
        
        footer button {
            background: rgba(255, 70, 70, 0.2);
            border-color: rgba(255, 70, 70, 0.4);
        }
    </style>
</head>
<body>
    <div class="container">
        <button id="langToggle" class="lang-toggle" aria-label="Toggle language">
            <span class="lang-option active" data-lang="en">EN</span>
            <span class="lang-divider">|</span>
            <span class="lang-option" data-lang="hu">HU</span>
        </button>

        <header class="profile">
            <h1 data-en="Web Tech Playground" data-hu="Web Tech JÃ¡tszÃ³tÃ©r">Web Tech Playground</h1>
            <p class="tagline" data-en="Full Interactive JS Suite" data-hu="Teljes InteraktÃ­v JS KÃ©szlet">Full Interactive JS Suite</p>
        </header>

        <div class="playground-card">
            <h2 data-en="Dynamic Page Header" data-hu="Dinamikus OldalfejlÃ©c">Dynamic Page Header</h2>
            <input placeholder="New page title..." data-en-placeholder="Type new title..." data-hu-placeholder="Ãºj oldal cÃ­m..." id="ujize">
            <button onclick="changePageTitle()" data-en="Apply" data-hu="Alkalmaz">Apply</button>
        </div>

        <div class="playground-card">
            <h2 data-en="Interactive Replier" data-hu="InteraktÃ­v VÃ¡laszadÃ³">Interactive Replier</h2>
            
            <div id="greet-en">
                <p>I <input placeholder="love..." id="masolat1"> you!</p>
                <button onclick="message1()">Click Me!</button>
            </div>

            <div id="greet-hu" class="hidden">
                <p>Ã‰n <input placeholder="szeretlek..." id="masolat2"> tÃ©ged!</p>
                <button onclick="message2()">Nyomj meg!</button>
            </div>
        </div>

        <div class="playground-card">
            <h2 data-en="Logic Engine" data-hu="Logikai Motor">Logic Engine</h2>
            <div class="calc-row">
                <input style="width: 60px;" id="a5" type="number"> <span>+</span>
                <input style="width: 60px;" id="b5" type="number">
                <button onclick="calc('+', 'a5', 'b5', 'result5')">=</button>
                <button class="result-btn" id="result5" disabled>0</button>
            </div>
            <div class="calc-row">
                <input style="width: 60px;" id="a6" type="number"> <span>-</span>
                <input style="width: 60px;" id="b6" type="number">
                <button onclick="calc('-', 'a6', 'b6', 'result6')">=</button>
                <button class="result-btn" id="result6" disabled>0</button>
            </div>
            <div class="calc-row">
                <input style="width: 60px;" id="a7" type="number"> <span>Ã—</span>
                <input style="width: 60px;" id="b7" type="number">
                <button onclick="calc('*', 'a7', 'b7', 'result7')">=</button>
                <button class="result-btn" id="result7" disabled>0</button>
            </div>
            <div class="calc-row">
                <input style="width: 60px;" id="a8" type="number"> <span>Ã·</span>
                <input style="width: 60px;" id="b8" type="number">
                <button onclick="calc('/', 'a8', 'b8', 'result8')">=</button>
                <button class="result-btn" id="result8" disabled>NaN</button>
            </div>
        </div>

        <div class="playground-card">
            <h2 data-en="Emoji Hub" data-hu="Emoji KÃ¶zpont">Emoji Hub</h2>
            <h3 data-en="Click to copy, paste below to test:" data-hu="MÃ¡solÃ¡shoz kattints, tesztelÃ©shez illeszd be:">Click to copy, paste below to test:</h3>
            <input style="width: 90%; margin-bottom: 15px;" type="text" placeholder="Ctrl + V here">
            
            <div class="emoji-grid">
                <button onclick="SelfCopy('ğŸ¶')">ğŸ¶</button> <button onclick="SelfCopy('ğŸ‡')">ğŸ‡</button>
                <button onclick="SelfCopy('ğŸˆ')">ğŸˆ</button> <button onclick="SelfCopy('ğŸ‰')">ğŸ‰</button>
                <button onclick="SelfCopy('ğŸŠ')">ğŸŠ</button> <button onclick="SelfCopy('ğŸ‹')">ğŸ‹</button>
                <button onclick="SelfCopy('ğŸŒ')">ğŸŒ</button> <button onclick="SelfCopy('ğŸ')">ğŸ</button>
                <button onclick="SelfCopy('ğŸ¥­')">ğŸ¥­</button> <button onclick="SelfCopy('ğŸ')">ğŸ</button>
                <button onclick="SelfCopy('ğŸ')">ğŸ</button> <button onclick="SelfCopy('ğŸ')">ğŸ</button>
                <button onclick="SelfCopy('ğŸ‘')">ğŸ‘</button> <button onclick="SelfCopy('ğŸ’')">ğŸ’</button>
                <button onclick="SelfCopy('ğŸ“')">ğŸ“</button> <button onclick="SelfCopy('ğŸ¥')">ğŸ¥</button>
                <button onclick="SelfCopy('ğŸ…')">ğŸ…</button> <button onclick="SelfCopy('ğŸ¥¥')">ğŸ¥¥</button>
                <button onclick="SelfCopy('ğŸ¥‘')">ğŸ¥‘</button> <button onclick="SelfCopy('ğŸ†')">ğŸ†</button>
                <button onclick="SelfCopy('ğŸ¥”')">ğŸ¥”</button> <button onclick="SelfCopy('ğŸ¥•')">ğŸ¥•</button>
                <button onclick="SelfCopy('ğŸŒ½')">ğŸŒ½</button> <button onclick="SelfCopy('ğŸŒ¶ï¸')">ğŸŒ¶ï¸</button>
                <button onclick="SelfCopy('ğŸ¥’')">ğŸ¥’</button> <button onclick="SelfCopy('ğŸ¥¬')">ğŸ¥¬</button>
                <button onclick="SelfCopy('ğŸ¥¦')">ğŸ¥¦</button> <button onclick="SelfCopy('ğŸ§„')">ğŸ§„</button>
                <button onclick="SelfCopy('ğŸ§…')">ğŸ§…</button> <button onclick="SelfCopy('ğŸ„')">ğŸ„</button>
                <button onclick="SelfCopy('ğŸ¥œ')">ğŸ¥œ</button> <button onclick="SelfCopy('ğŸ')">ğŸ</button> 
                <button onclick="SelfCopy('ğŸ¥')">ğŸ¥</button> <button onclick="SelfCopy('ğŸ¥–')">ğŸ¥–</button> 
                <button onclick="SelfCopy('ğŸ¥¨')">ğŸ¥¨</button> <button onclick="SelfCopy('ğŸ¥¯')">ğŸ¥¯</button> 
                <button onclick="SelfCopy('ğŸ¥')">ğŸ¥</button> <button onclick="SelfCopy('ğŸ§‡')">ğŸ§‡</button> 
                <button onclick="SelfCopy('ğŸ§€')">ğŸ§€</button>
            </div>
        </div>

        <div class="playground-card">
            <h2>Unicode ASCII Explorer</h2>
            <p data-en="Iterate through the global character library." data-hu="BÃ¶ngÃ©ssz a globÃ¡lis karakterkÃ¶nyvtÃ¡ron keresztÃ¼l.">Iterate through the global character library.</p>
            <p>
                <span data-en="You can type this character using:" 
                    data-hu="Ezt a karaktert Ã­gy tudod begÃ©pelni:">
                    You can type this character using:
                </span>
                <strong>
                    Alt + <span id="altCodeValue">0</span>
                </strong>
                <span data-en="(on the numeric keypad)"
                    data-hu="(a numerikus billentyÅ±zeten)">
                    (on the numeric keypad)
                </span>
            </p>

            <div style="display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 15px;">
                <input type="number" id="charCodeInput" class="btndsbl2" min="0" style="flex: 1; max-width: 200px; text-align: center; font-size: 16px; padding: 10px; border: 1px solid rgba(255,200,100,0.3); border-radius: 8px; background: rgba(0,0,0,0.2); color: #E0E0E0;" disabled>
                <span style="font-size: 20px; font-weight: bold;">â¡ï¸</span>
                <button id="demoBtn" class="result-btn" style="flex: 1; max-width: 100px; font-size: 24px; padding: 15px; cursor: pointer;">&#0;</button>
                <button id="editModeToggle" title="Edit mode" style="padding: 8px 12px; background: rgba(255, 165, 0, 0.2); border: 1px solid rgba(255,165,0,0.4); color: #E0E0E0; border-radius: 6px; cursor: pointer; font-size: 16px;">âš™ï¸</button>
            </div>
            <div class="calc-row">
                <button onclick="emojiGenPrev()">Previous</button>
                <button onclick="emojiGen()">Next Code</button>
            </div>
        </div>

        <footer>
            <button onclick="window.close()" data-en="Exit Playground" data-hu="KilÃ©pÃ©s">Exit Playground</button>
        </footer>
        
        <!-- Back to Top Button -->
        <button id="backToTop" class="back-to-top" aria-label="Back to top" title="Back to top">
            <svg viewBox="0 0 24 24" fill="currentColor" width="24" height="24">
                <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/>
            </svg>
        </button>
    </div>

    <script>
    let currentLang = 'en';
    let charNum = parseInt(localStorage.getItem('unicodeCharNum') || '0', 10);

    // Refactored Translation logic to be more forceful with language pairs
    async function translateText(text, source, target) {
        if (!text || text.trim() === "") return text;
        try {
            const response = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${source}&tl=${target}&dt=t&q=${encodeURI(text)}`);
            const data = await response.json();
            return data[0][0][0];
        } catch (e) { 
            console.error("Translation failed:", e);
            return text; 
        }
    }

    const langToggle = document.getElementById('langToggle');

    // Initialize character display with saved value
    updateCharacterDisplay();
    langToggle.addEventListener('click', async () => {
        const oldLang = currentLang;
        currentLang = currentLang === 'en' ? 'hu' : 'en';
        let translatedTitle = document.title;
        if (document.title === "Web Tech Playground" && oldLang === 'en' && currentLang === 'hu') {
            translatedTitle = "Web Tech JÃ¡tszÃ³tÃ©r";
        } else if (document.title === "Web Tech JÃ¡tszÃ³tÃ©r" && oldLang === 'hu' && currentLang === 'en') {
            translatedTitle = "Web Tech Playground";
        } else {
            translatedTitle = await translateText(document.title, oldLang, currentLang);
        }
        document.querySelectorAll('[data-en]').forEach(el => {
            el.textContent = el.getAttribute(`data-${currentLang}`);
        });
        document.querySelectorAll('[data-en-placeholder]').forEach(el => {
            el.placeholder = el.getAttribute(`data-${currentLang}-placeholder`);
        });
        document.title = translatedTitle;
        document.getElementById('greet-en').classList.toggle('hidden', currentLang !== 'en');
        document.getElementById('greet-hu').classList.toggle('hidden', currentLang !== 'hu');
        document.querySelectorAll('.lang-option').forEach(opt => opt.classList.toggle('active'));
    });

    function changePageTitle() {
        const val = document.getElementById('ujize').value;
        if(!val) {
            alert(currentLang === 'en' ? "Input is empty!" : "A mezÅ‘ Ã¼res!");
            return;
        }
        document.title = val;
    }

    function message1() {
        const val = document.getElementById('masolat1').value;
        alert(val ? `I ${val} you too!` : "You need to write something!");
    }

    function message2() {
        const val = document.getElementById('masolat2').value;
        alert(val ? `Ã‰n is ${val} tÃ©ged!` : "Ãrnod kell valamit!");
    }

    function calc(op, id1, id2, resId) {
        const n1 = Number(document.getElementById(id1).value);
        const n2 = Number(document.getElementById(id2).value);
        let res = op === '+' ? n1 + n2 : op === '-' ? n1 - n2 : op === '*' ? n1 * n2 : n1 / n2;
        document.getElementById(resId).innerHTML = res;
    }

    /* ================= Unicode ASCII Explorer FIXED ================= */

    let editMode = false;
    let numberChanged = false;
    let charChanged = false;

    /* ---------- Display ---------- */
    function updateCharacterDisplay() {
        const charCodeInput = document.getElementById('charCodeInput');
        const demoBtn = document.getElementById('demoBtn');
        const altCodeValue = document.getElementById('altCodeValue');

        charCodeInput.value = charNum;
        demoBtn.textContent = String.fromCodePoint(charNum);

        // Update ALT code display (if present)
        if (altCodeValue) {
            altCodeValue.textContent = charNum;
        }

        localStorage.setItem('unicodeCharNum', charNum);
    }


    /* ---------- Edit Mode ---------- */
    function enterEditMode() {
        editMode = true;
        numberChanged = false;
        charChanged = false;

        const input = document.getElementById('charCodeInput');
        const btn = document.getElementById('demoBtn');

        input.disabled = false;
        btn.contentEditable = true;

        // ğŸ‘ï¸ visual clarity
        btn.style.border = '2px dashed orange';
        btn.style.background = 'rgba(255,165,0,0.15)';
        btn.style.cursor = 'text';

        document.getElementById('editModeToggle').style.background =
            'rgba(255, 165, 0, 0.5)';

        input.focus();
    }

    function exitEditMode(apply = true) {
        const input = document.getElementById('charCodeInput');
        const btn = document.getElementById('demoBtn');

        input.disabled = true;
        btn.contentEditable = false;

        btn.style.border = '';
        btn.style.background = '';
        btn.style.cursor = 'pointer';

        document.getElementById('editModeToggle').style.background =
            'rgba(255, 165, 0, 0.2)';

        editMode = false;

        if (apply) applyChanges();
    }

    /* ---------- Apply Changes ---------- */
    function applyChanges() {
        const input = document.getElementById('charCodeInput');
        const btn = document.getElementById('demoBtn');

        const num = parseInt(input.value, 10);
        const chars = Array.from(btn.textContent || '');

        if (numberChanged && !isNaN(num) && num >= 0) {
            charNum = num;
        } else if (charChanged && chars.length > 0) {
            charNum = chars[0].codePointAt(0);
        }

        updateCharacterDisplay();
    }

    /* ---------- Next / Previous ---------- */
    function emojiGen() {
        if (editMode) {
            applyChanges(); // Apply changes before incrementing
        }
        charNum++;
        updateCharacterDisplay();
    }

    function emojiGenPrev() {
        if (editMode) {
            applyChanges(); // Apply changes before decrementing
        }
        if (charNum > 0) charNum--;
        updateCharacterDisplay();
    }

    /* ---------- DOM Events ---------- */
    document.addEventListener('DOMContentLoaded', () => {
        const input = document.getElementById('charCodeInput');
        const btn = document.getElementById('demoBtn');
        const toggle = document.getElementById('editModeToggle');

        updateCharacterDisplay();

        toggle.addEventListener('click', () => {
            editMode ? exitEditMode(true) : enterEditMode();
        });

        input.addEventListener('input', () => {
            if (!editMode) return;
            numberChanged = true;

            const n = parseInt(input.value, 10);
            if (!isNaN(n) && n >= 0) {
                btn.textContent = String.fromCodePoint(n);
            }
        });

        btn.addEventListener('input', () => {
            if (!editMode) return;
            charChanged = true;

            // ğŸ”’ allow ONLY one Unicode character
            const chars = Array.from(btn.textContent);
            if (chars.length > 1) {
                btn.textContent = chars[0];
                placeCaretAtEnd(btn);
            }
        });

        btn.addEventListener('click', () => {
            if (!editMode) {
                navigator.clipboard.writeText(btn.textContent);
                alert((currentLang === 'en' ? 'Copied: ' : 'MÃ¡solva: ') + btn.textContent);
            }
        });
    });

    /* ---------- Caret helper ---------- */
    function placeCaretAtEnd(el) {
        const range = document.createRange();
        const sel = window.getSelection();
        range.selectNodeContents(el);
        range.collapse(false);
        sel.removeAllRanges();
        sel.addRange(range);
    }

    // ---------------- Back to Top ----------------
    document.addEventListener('DOMContentLoaded', () => {
        const backToTopBtn = document.getElementById('backToTop');
        
        if (backToTopBtn) {
            let scrollAnimationId = null;
            window.addEventListener('scroll', () => {
                if (window.scrollY > 300) backToTopBtn.classList.add('visible');
                else backToTopBtn.classList.remove('visible');
            });
            backToTopBtn.addEventListener('click', () => {
                if (scrollAnimationId !== null) {
                    cancelAnimationFrame(scrollAnimationId);
                    window.scrollTo(0, 0);
                    scrollAnimationId = null;
                    return;
                }
                const startPosition = window.scrollY;
                const duration = 1200;
                const startTime = performance.now();
                function easeOutCubic(t) { return 1 - Math.pow(1 - t, 3); }
                function scroll(currentTime) {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    const easing = easeOutCubic(progress);
                    window.scrollTo(0, startPosition * (1 - easing));
                    if (progress < 1) scrollAnimationId = requestAnimationFrame(scroll);
                    else scrollAnimationId = null;
                }
                scrollAnimationId = requestAnimationFrame(scroll);
            });
        }
    });

    // ----------------- Self Copy -----------------
    function SelfCopy(emoji) {
        navigator.clipboard.writeText(emoji).then(() => {
            alert((currentLang === 'en' ? 'Copied: ' : 'MÃ¡solva: ') + emoji);
        }).catch(err => {
            console.error('Failed to copy:', err);
            alert(currentLang === 'en' ? 'Copy failed!' : 'MÃ¡solÃ¡s sikertelen!');
        });
    }
    </script>

</body>
</html>